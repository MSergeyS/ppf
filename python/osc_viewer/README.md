# new_wave

## Описание

`new_wave` — это набор инструментов для анализа и визуализации сигналов, включая загрузку, обработку, преобразование Фурье и отображение данных с помощью графического интерфейса. Проект состоит из отдельных модулей для работы с сигналами, а также приложения для просмотра и анализа данных осциллографа.

---

## Структура репозитория

```
python/
├── fft_signal.py
├── load_and_prepare_data.py
├── osc_python.ipynb
├── plot_peaks_periodogram.py
├── reader_dds.py
├── osc_viewer/
│   ├── create_spectrume.py
│   ├── example_PlotData.py
│   ├── load_and_prepare_data.py
│   ├── main.py
│   ├── osc_context_menu.py
│   ├── osc_viewer.ini
│   ├── PlotData.py
│   ├── README.md
│   ├── spectr_context_menu.py
|   ├── requirements.txt
│   ├── test_PlotData.py
│   └── __pycache__/
└── __pycache__/
```

### Корневые модули

- **fft_signal.py** — функции для вычисления и анализа БПФ (быстрого преобразования Фурье) сигналов.
- **load_and_prepare_data.py** — загрузка и подготовка данных для дальнейшей обработки.
- **plot_peaks_periodogram.py** — построение периодограммы и выделение пиков спектра.
- **reader_dds.py** — чтение данных с DDS (Direct Digital Synthesis) устройств.
- **osc_python.ipynb** — Jupyter-ноутбук с примерами анализа сигналов.

### Каталог `osc_viewer/`

- **main.py** — основной исполняемый файл GUI-приложения для просмотра сигналов и спектров.
- **load_and_prepare_data.py** — загрузка и подготовка данных для визуализации.
- **create_spectrume.py** — функции для построения спектра сигнала.
- **osc_context_menu.py** — реализация контекстного меню для графиков сигналов.
- **spectr_context_menu.py** — контекстное меню для спектральных графиков.
- **osc_viewer.ini** — конфигурационный файл приложения.
- **PlotData.py** — класс для хранения и обработки данных графиков.
- **test_PlotData.py** — модуль тестов для класса PlotData.
- **example_PlotData.py** — пример использования класса PlotData.
- **README.md** — описание и инструкции по запуску приложения.
- **requirements.txt** — список необходимых зависимостей Python для установки и запуска проекта.
---

### Файл requirements.txt

Пример содержимого для `requirements.txt`:

```
numpy
scipy
matplotlib
PyQt6
pandas
```

> Для запуска тестов добавьте (опционально):
> ```
> pytest
> ```

---

## Установка

1. **Клонируйте репозиторий:**
    ```sh
    git clone <URL-репозитория>
    cd new_wave/python
    ```

2. **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```sh
    python -m venv venv
    source venv/bin/activate  # или venv\Scripts\activate для Windows
    ```

3. **Установите зависимости:**
    ```sh
    pip install -r requirements.txt
    ```
    > Если файл `requirements.txt` отсутствует, установите основные библиотеки вручную:
    ```sh
    pip install numpy scipy matplotlib PyQt6 pandas
    ```

    ## Требуемые зависимости

    Для запуска основных модулей (`main.py`, `PlotData.py`, `create_spectrume.py`, `osc_context_menu.py`, `spectr_context_menu.py`, `load_and_prepare_data.py`, `test_PlotData.py`, `example_PlotData.py`) необходимы следующие пакеты Python:

    - **numpy** — численные вычисления и работа с массивами
    - **scipy** — научные вычисления (для анализа сигналов)
    - **matplotlib** — построение графиков и интеграция с PyQt
    - **PyQt6** — графический интерфейс (Qt6)
    - **pytest** или **unittest** — для запуска тестов (опционально, только для тестирования)
    - **pandas** — для работы с метаинформацией и таблицами (используется в `load_and_prepare_data.py`)

    Установите их командой:

    ```sh
    pip install numpy scipy matplotlib PyQt6 pandas
    ```

    > **Примечание:**  
    > Если используете тесты, дополнительно установите `pytest`:
    > ```sh
    > pip install pytest
    > ```

---

## Запуск приложения

Для запуска графического интерфейса используйте:

```sh
cd osc_viewer
python main.py
```

---

## Примеры использования

- **Jupyter Notebook:**  
  Откройте `osc_python.ipynb` для интерактивного анализа сигналов.
- **Пример работы с PlotData:**  
  Запустите `example_PlotData.py` для демонстрации работы с классом данных.

---

## Тестирование

Для запуска тестов используйте:

```sh
cd osc_viewer
python -m unittest test_PlotData.py
```

---

## Как это работает

1. **Загрузка данных:**  
    Используйте модули `load_and_prepare_data.py` для чтения и подготовки данных из файлов или устройств.

2. **Обработка сигналов:**  
    Применяйте функции из `fft_signal.py` и `plot_peaks_periodogram.py` для анализа спектра и поиска пиков.

3. **Визуализация:**  
    Запустите `osc_viewer/main.py` для интерактивного просмотра сигналов и спектров с помощью удобного GUI.

4. **Расширяемость:**  
    Проект легко расширять за счёт модульной структуры и наличия примеров и тестов.

## Основной функционал приложения OscViewer

**OscViewer** — это приложение для визуализации сигналов и их спектров с помощью графического интерфейса на PyQt6 и библиотеки matplotlib. Программа предназначена для загрузки сигналов из CSV-файлов, их анализа, построения графиков и спектров, а также для удобного взаимодействия с данными через контекстные меню и вкладки.

---

### Ключевые возможности по модулям

- **[`main.py`](osc_viewer/main.py)** — главное окно приложения:
    - Вкладки: **График** (осциллограмма), **Сообщения** (логи/статус), **Спектр** (амплитудный спектр)
    - Меню **Файл** с возможностью открыть CSV-файл
    - Перенаправление вывода `print` в окно сообщений GUI
    - Контекстные меню для графика и спектра (вызываются правой кнопкой мыши)
    - Работа с несколькими линиями на графиках, поддержка их параметров (цвет, стиль, подпись)
    - Гибкая настройка интерфейса через `QTabWidget` и `QVBoxLayout`

- **[`PlotData.py`](osc_viewer/PlotData.py)** — класс для работы с графиками:
    - Инкапсулирует работу с matplotlib-графиками внутри Qt-виджета
    - Позволяет строить, удалять, выделять линии, настраивать оси, сетку, легенду
    - Поддерживает интерактивное управление графиком (выделение, удаление, масштабирование)
    - Позволяет получать параметры линий, их список, очищать и обновлять график
    - Используется для отображения как осциллограмм, так и спектров

- **[`osc_context_menu.py`](osc_viewer/osc_context_menu.py)** — контекстное меню для графика сигнала:
    - Сохранение изображения графика (PNG)
    - Очистка графика
    - Построение спектра по выбранной (активной) линии
    - Взаимодействие с главным окном и `PlotData` для выполнения действий

- **[`spectr_context_menu.py`](osc_viewer/spectr_context_menu.py)** — контекстное меню для вкладки "Спектр":
    - Переключение масштаба оси Y между Вольтами и децибелами (дБ)
    - Сохранение изображения спектра (PNG)
    - Очистка графика спектра
    - Перерисовка всех линий спектра при смене режима отображения

- **[`create_spectrume.py`](osc_viewer/create_spectrume.py)** — вычисление и отображение спектра:
    - Функция БПФ (быстрое преобразование Фурье) для получения спектра сигнала
    - Построение спектра по выбранной линии, отображение в В или дБ
    - Управление режимом отображения спектра (В/дБ)
    - Автоматическое добавление спектра на отдельную вкладку, блокировка перемещения линий на спектре

- **[`load_and_prepare_data.py`](osc_viewer/load_and_prepare_data.py)** — загрузка и подготовка данных:
    - Открытие CSV-файлов с сигналами через диалоговое окно
    - Загрузка и парсинг метаинформации, временных и сигнальных данных
    - Даунсемплирование, удаление постоянной составляющей, дополнение до нужной длины
    - Отображение загруженного сигнала на графике
    - Сохранение и восстановление последней директории для удобства пользователя

---

### Итоговые возможности

- Удобная загрузка, просмотр и анализ сигналов и их спектров
- Современный графический интерфейс с поддержкой:
    - Интерактивных графиков
    - Контекстных меню
    - Расширенных функций визуализации

> Для подробностей смотрите исходные файлы в каталоге [`osc_viewer/`](osc_viewer/).

---

## Контакты

Для вопросов и предложений создайте issue или свяжитесь с автором проекта.
